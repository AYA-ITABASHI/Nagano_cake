<div class="container">
  <div class="row">
    <div class="col-sm-3  rounded  m-4">
     <h4 class="text-center", style="background-color: #dcdcdc">注文履歴詳細</h4>
    </div>
  </div>

 <div class="row-fluid justify-content-start">
  <table>
   <tr>
    <th class="col-md-1">購入者</th>
    <td class="col-md-4"><%= @order.customer.last_name %><%= @order.customer.first_name %></td>
   </tr>
   <tr>
    <th class="col-md-1">購入日時</th>
    <td class="col-md-4"><%= l @order.created_at, format: :date %></td>
   </tr>
   <tr>
    <th class="col-md-1">配送先</th>
    <td class="col-md-4">
     <%=  @order.delivery_postal_code %>
     <%= @order.delivery_address %>
     <%= @order.delivery_name %>
    </td>
   </tr>
   <tr>
    <th class="col-md-1">支払い方法</th>
    <td class="col-md-4"><%= @order.payment_i18n %></td>
   </tr>

    <tr>
     <th class="col-md-1">注文ステータス</th>
     <td class="col-md-4">
      <%= form_with model:@order, url:admin_order_path(@order.id), method: :patch do |f| %>
       <%= f.select :order_status, Order.order_statuses_i18n.invert %>
       <%= f.submit "更新",class: "btn btn-success btn-sm" %>
      <% end %>
     </td>
    </tr>

  </table>
 </div>

 <div class="row-fluid justify-content-start mt-5">
  <table >
  <% @total=0 %>
  <thead class="table-secondary">
   <tr >
    <th  class="col-md-2">商品名</th>
    <th  class="col-md-2">単価（税込）</th>
    <th  class="col-md-1">数量</th>
    <th  class="col-md-1">小計</th>
    <th  class="col-md-4">製作ステータス</th>
   </tr>
  </thead>
  <% @order_details.each do |orders| %>
  <tbody>
   <tr>
    <td class="col-md-2"><%= orders.item.name %> </td>
    <td class="col-md-2"><%= orders.unit_price %></td>
    <td class="col-md-1"><%= orders.amount %></td>
    <td class="col-md-1"><%= orders.unit_price*orders.amount %></td>
    <%= form_with model:orders, url:admin_order_detail_path(orders.id), method: :patch do |f| %>
    <td class="col-md-4">
      <%= f.select :making_status, OrderDetail.making_statuses_i18n.invert %>
      <%= f.submit "更新", class: "btn btn-success btn-sm"  %>
    <% end %>
    </td>
   </tr>
  </tbody>
    <% @total += orders.unit_price*orders.amount %>
  <% end %>
  </table>
 </div>

 <div class="row justify-content-end">
  <table>
   <tr >
    <th class="col-md-2" >商品合計</th>
    <td class="col-md-1">
     <%= @total %>
    </td>
   </tr>
   <tr>
    <th class="col-md-2">配送料</th>
    <td class="col-md-1"><%= @order.shipping_fee %></td>
   </tr>
   <tr>
    <th class="col-md-2">請求金額合計</th>
    <td class="col-md-1"><%= @order.amount_billed %></td>
   </tr>
  </table>
 </div>